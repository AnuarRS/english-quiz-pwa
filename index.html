<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnglishBoost - –û–±—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º—É</title>
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }

        .quiz-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 600px;
            overflow: hidden;
        }

        /* –°—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        .header {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            padding: 15px 20px;
            color: white;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: white;
            color: #667eea;
        }

        .progress-container {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            height: 16px;
            overflow: hidden;
        }

        .progress-bar {
            background: #58cc02;
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .score {
            font-size: 16px;
            font-weight: bold;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            padding: 25px;
            text-align: center;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .screen {
            display: none;
        }

        .active {
            display: block;
        }

        .loading-screen {
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é */
        .menu-title {
            font-size: 2em;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 8px;
        }

        .menu-subtitle {
            font-size: 1em;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .level-card {
            border: none;
            border-radius: 15px;
            padding: 25px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            color: white;
        }

        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .level-card.a1 { background: linear-gradient(135deg, #a8e6cf 0%, #56ab91 100%); }
        .level-card.a2 { background: linear-gradient(135deg, #81c784 0%, #4caf50 100%); }
        .level-card.b1 { background: linear-gradient(135deg, #ffd54f 0%, #ffa726 100%); }
        .level-card.b2 { background: linear-gradient(135deg, #ff8a65 0%, #f4511e 100%); }
        .level-card.c1 { background: linear-gradient(135deg, #e57373 0%, #d32f2f 100%); }
        .level-card.c2 { background: linear-gradient(135deg, #9575cd 0%, #673ab7 100%); }

        .level-name {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .level-description {
            font-size: 1em;
            opacity: 0.95;
        }

        /* –ò–≥—Ä–∞ –∑–º–µ–π–∫–∞ */
        .snake-game-area {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 400px;
            margin: 0 auto 20px;
            background: #f5f7fa;
            border-radius: 15px;
            border: 3px solid #dfe4ea;
            overflow: hidden;
        }

        .snake-segment {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #00b894;
            border-radius: 4px;
            z-index: 2;
        }

        .snake-head {
            background: #0984e3;
            box-shadow: 0 2px 8px rgba(9, 132, 227, 0.6);
            z-index: 3;
        }

        .letter-food {
            position: absolute;
            width: 25px;
            height: 25px;
            background: #667eea;
            color: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 1;
            box-shadow: 0 3px 8px rgba(102, 126, 234, 0.4);
        }

        .letter-food.target {
            background: #ffd700;
            animation: pulse 1s infinite;
            transform: scale(1.2);
            z-index: 4;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1.2); }
            50% { transform: scale(1.4); }
        }

        .snake-word-display {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e8e8e8;
        }

        .snake-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 20px auto;
            width: 180px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
        }

        .snake-btn {
            width: 50px;
            height: 50px;
            background: #667eea;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            box-shadow: 0 3px 6px rgba(102, 126, 234, 0.3);
        }

        .snake-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.5);
        }

        .snake-btn.up { grid-column: 2; grid-row: 1; }
        .snake-btn.left { grid-column: 1; grid-row: 2; }
        .snake-btn.right { grid-column: 3; grid-row: 2; }
        .snake-btn.down { grid-column: 2; grid-row: 3; }

        .snake-hint {
            text-align: center;
            color: #636e72;
            font-size: 0.9em;
            margin-top: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .action-btn {
            background: #58cc02;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(88, 204, 2, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(88, 204, 2, 0.4);
        }

        .action-btn.secondary {
            background: transparent;
            color: #74b9ff;
            border: 2px solid #74b9ff;
            box-shadow: none;
        }

        .action-btn.secondary:hover {
            background: #74b9ff;
            color: white;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .message {
            padding: 15px;
            margin: 15px 0;
            border-radius: 12px;
            font-weight: bold;
            text-align: center;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 600px) {
            .levels-grid {
                grid-template-columns: 1fr;
            }
            
            .snake-game-area {
                height: 300px;
            }
            
            .level-card {
                padding: 20px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <div class="header">
            <div class="header-top">
                <button class="btn" id="backBtn" style="display: none;">‚úï</button>
                <div class="score">
                    <span id="currentLevel"></span>
                    <span id="scoreDisplay" style="display: none;">üíé <span id="score">0</span></span>
                </div>
                <button class="btn" id="helpBtn">‚ùì</button>
            </div>
            <div class="progress-container" id="progressContainer" style="display: none;">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>

        <div class="main-content">
            <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
            <div class="screen active" id="mainMenu">
                <div class="menu-title">EnglishBoost</div>
                <div class="menu-subtitle">–ò–∑—É—á–∞–π—Ç–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —Å –ø–æ–º–æ—â—å—é –∏–≥—Ä</div>
                
                <div class="levels-grid" id="levelsGrid"></div>
                
                <button class="action-btn" onclick="showScreen('helpScreen')">–ü–æ–º–æ—â—å</button>
            </div>

            <!-- –ü–æ–º–æ—â—å -->
            <div class="screen" id="helpScreen">
                <h3>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h3>
                <p>–°–æ–±–∏—Ä–∞–π—Ç–µ –±—É–∫–≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —Å –ø–æ–º–æ—â—å—é –∑–º–µ–π–∫–∏.</p>
                <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ –∫–ª–∞–≤–∏—à–∏ —Å—Ç—Ä–µ–ª–æ–∫ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ.</p>
                <p>–°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ –±—É–∫–≤—ã —Å–ª–æ–≤–∞, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É.</p>
                
                <button class="action-btn" onclick="showScreen('mainMenu')">–ù–∞–∑–∞–¥</button>
            </div>

            <!-- –ò–≥—Ä–∞ -->
            <div class="screen" id="gameScreen">
                <div class="snake-word-display" id="snakeWordDisplay">–°–æ–±—Ä–∞–Ω–æ: </div>
                <div class="snake-game-area" id="snakeGameArea"></div>
                <div class="snake-controls">
                    <button class="snake-btn up" onclick="changeSnakeDirection('up')">‚Üë</button>
                    <button class="snake-btn left" onclick="changeSnakeDirection('left')">‚Üê</button>
                    <button class="snake-btn right" onclick="changeSnakeDirection('right')">‚Üí</button>
                    <button class="snake-btn down" onclick="changeSnakeDirection('down')">‚Üì</button>
                </div>
                <div class="snake-hint">–°–æ–±–µ—Ä–∏—Ç–µ –±—É–∫–≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ</div>
                
                <div class="message" id="gameMessage"></div>
                
                <button class="action-btn" onclick="endGame()">–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É</button>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <div class="screen" id="resultsScreen">
                <div style="font-size: 4em;">üéâ</div>
                <div style="font-size: 2em; font-weight: bold; color: #58cc02; margin: 20px 0;" id="finalScore">0/0</div>
                <div style="font-size: 1.2em; margin-bottom: 30px;" id="resultsMessage">–û—Ç–ª–∏—á–Ω–æ!</div>
                
                <button class="action-btn" onclick="restartGame()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                <button class="action-btn secondary" onclick="showScreen('mainMenu')">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
        const LEVELS = {
            'A1': { name: '–ù–∞—á–∞–ª—å–Ω—ã–π', words: ['CAT', 'DOG', 'SUN', 'RED', 'CAR'] },
            'A2': { name: '–ë–∞–∑–æ–≤—ã–π', words: ['HOUSE', 'WATER', 'APPLE', 'TABLE', 'BOOK'] },
            'B1': { name: '–°—Ä–µ–¥–Ω–∏–π', words: ['COMPUTER', 'TEACHER', 'STUDENT', 'PENCIL', 'SCHOOL'] },
            'B2': { name: '–í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ', words: ['UNIVERSITY', 'ELEPHANT', 'RESTAURANT', 'TELEVISION', 'GOVERNMENT'] },
            'C1': { name: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π', words: ['ENVIRONMENT', 'COMMUNICATION', 'INFORMATION', 'DEVELOPMENT', 'EXPERIENCE'] },
            'C2': { name: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π', words: ['ENTREPRENEURSHIP', 'INTERNATIONALIZATION', 'INCONVENIENCE', 'RESPONSIBILITY', 'DETERMINATION'] }
        };

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
        let currentLevel = '';
        let currentWordIndex = 0;
        let score = 0;
        let wordsCompleted = 0;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–º–µ–π–∫–∏
        let snake = [];
        let snakeDirection = 'right';
        let snakeInterval = null;
        let letterPositions = [];
        let collectedLetters = '';
        let currentWord = '';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            initLevels();
            document.getElementById('backBtn').addEventListener('click', goToMainMenu);
            document.getElementById('helpBtn').addEventListener('click', () => showScreen('helpScreen'));
        });

        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function goToMainMenu() {
            stopGame();
            document.getElementById('backBtn').style.display = 'none';
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('scoreDisplay').style.display = 'none';
            showScreen('mainMenu');
        }

        function initLevels() {
            const levelsGrid = document.getElementById('levelsGrid');
            
            for (const [level, data] of Object.entries(LEVELS)) {
                const card = document.createElement('div');
                card.className = `level-card ${level.toLowerCase()}`;
                card.onclick = () => selectLevel(level);
                
                const levelName = document.createElement('div');
                levelName.className = 'level-name';
                levelName.textContent = level;
                
                const description = document.createElement('div');
                description.className = 'level-description';
                description.textContent = data.name;
                
                card.appendChild(levelName);
                card.appendChild(description);
                levelsGrid.appendChild(card);
            }
        }

        function selectLevel(level) {
            currentLevel = level;
            document.getElementById('currentLevel').textContent = `${level} —É—Ä–æ–≤–µ–Ω—å | `;
            document.getElementById('scoreDisplay').style.display = 'inline';
            document.getElementById('backBtn').style.display = 'block';
            document.getElementById('progressContainer').style.display = 'block';
            
            startGame();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã
        function startGame() {
            currentWordIndex = 0;
            score = 0;
            wordsCompleted = 0;
            updateUI();
            showScreen('gameScreen');
            nextWord();
        }

        function nextWord() {
            if (currentWordIndex >= LEVELS[currentLevel].words.length) {
                endGame();
                return;
            }
            
            currentWord = LEVELS[currentLevel].words[currentWordIndex];
            initSnakeGame(currentWord);
            currentWordIndex++;
        }

        function initSnakeGame(word) {
            currentWord = word;
            collectedLetters = '';
            snakeDirection = 'right';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–º–µ–π–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ
            const centerX = 200;
            const centerY = 200;
            snake = [
                { x: centerX, y: centerY },
                { x: centerX - 20, y: centerY },
                { x: centerX - 40, y: centerY }
            ];

            // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –±—É–∫–≤ —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
            letterPositions = [];
            const letters = currentWord.split('');
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –±—É–∫–≤—ã —Ü–µ–ª–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
            letters.forEach((letter, index) => {
                let pos = getRandomSafePosition();
                letterPositions.push({ letter, x: pos.x, y: pos.y, isTarget: true, index });
            });

            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã (–≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ)
            for (let i = 0; i < 5; i++) {
                const randomLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                let pos = getRandomSafePosition();
                letterPositions.push({ letter: randomLetter, x: pos.x, y: pos.y, isTarget: false });
            }

            updateSnakeDisplay();
            renderSnakeGame();
            
            clearSnakeInterval();
            snakeInterval = setInterval(moveSnake, 150);
        }

        function getRandomSafePosition() {
            const safeDistance = 80; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
            let attempts = 0;
            let pos;
            
            do {
                pos = {
                    x: Math.floor(Math.random() * 18) * 20 + 10,
                    y: Math.floor(Math.random() * 18) * 20 + 10
                };
                attempts++;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ (200,200)
                const distanceFromCenter = Math.sqrt(
                    Math.pow(pos.x - 200, 2) + Math.pow(pos.y - 200, 2)
                );
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –∑–º–µ–π–∫–∏
                let tooCloseToSnake = snake.some(segment => 
                    Math.abs(segment.x - pos.x) < 40 && Math.abs(segment.y - pos.y) < 40
                );
                
                if (distanceFromCenter >= safeDistance && !tooCloseToSnake) {
                    return pos;
                }
            } while (attempts < 50);
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ª—é–±—É—é
            return {
                x: Math.floor(Math.random() * 18) * 20 + 10,
                y: Math.floor(Math.random() * 18) * 20 + 10
            };
        }

        function renderSnakeGame() {
            const gameArea = document.getElementById('snakeGameArea');
            gameArea.innerHTML = '';

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–º–µ–π–∫–∏
            snake.forEach((segment, index) => {
                const segmentEl = document.createElement('div');
                segmentEl.className = 'snake-segment' + (index === 0 ? ' snake-head' : '');
                segmentEl.style.left = segment.x + 'px';
                segmentEl.style.top = segment.y + 'px';
                gameArea.appendChild(segmentEl);
            });

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –±—É–∫–≤
            letterPositions.forEach((letterPos) => {
                const letterEl = document.createElement('div');
                letterEl.className = 'letter-food';
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Ü–µ–ª–µ–≤—É—é –±—É–∫–≤—É
                if (letterPos.isTarget && letterPos.index === collectedLetters.length) {
                    letterEl.classList.add('target');
                }
                
                letterEl.textContent = letterPos.letter;
                letterEl.style.left = (letterPos.x - 12.5) + 'px';
                letterEl.style.top = (letterPos.y - 12.5) + 'px';
                gameArea.appendChild(letterEl);
            });
        }

        function moveSnake() {
            const head = { ...snake[0] };

            switch (snakeDirection) {
                case 'up': head.y -= 20; break;
                case 'down': head.y += 20; break;
                case 'left': head.x -= 20; break;
                case 'right': head.x += 20; break;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏
            if (head.x < 0 || head.x >= 400 || head.y < 0 || head.y >= 400) {
                gameOver();
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Å–æ–±–æ–π
            if (snake.some((segment, index) => index > 0 && segment.x === head.x && segment.y === head.y)) {
                gameOver();
                return;
            }

            snake.unshift(head);

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –±—É–∫–≤–æ–π
            const collisionIndex = letterPositions.findIndex(letter => 
                Math.abs(letter.x - head.x) < 20 && Math.abs(letter.y - head.y) < 20
            );

            if (collisionIndex !== -1) {
                const collectedLetter = letterPositions[collisionIndex];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–∏ —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∞—è –±—É–∫–≤–∞
                if (collectedLetter.isTarget && collectedLetter.index === collectedLetters.length) {
                    collectedLetters += collectedLetter.letter;
                    letterPositions.splice(collisionIndex, 1);
                    updateSnakeDisplay();

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–±—Ä–∞–Ω–æ –ª–∏ –≤—Å–µ —Å–ª–æ–≤–æ
                    if (collectedLetters === currentWord) {
                        processWordComplete();
                        return;
                    }
                } else {
                    // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±—É–∫–≤–∞ - –∫–æ–Ω–µ—Ü –∏–≥—Ä—ã
                    gameOver();
                    return;
                }
            } else {
                snake.pop();
            }

            renderSnakeGame();
        }

        function changeSnakeDirection(newDirection) {
            const opposites = { up: 'down', down: 'up', left: 'right', right: 'left' };
            if (snakeDirection !== opposites[newDirection] && snake.length > 1) {
                snakeDirection = newDirection;
            } else if (snake.length === 1) {
                snakeDirection = newDirection;
            }
        }

        function updateSnakeDisplay() {
            document.getElementById('snakeWordDisplay').textContent = 
                `–°–æ–±—Ä–∞–Ω–æ: ${collectedLetters} / ${currentWord}`;
        }

        function clearSnakeInterval() {
            if (snakeInterval) {
                clearInterval(snakeInterval);
                snakeInterval = null;
            }
        }

        function gameOver() {
            clearSnakeInterval();
            const message = document.getElementById('gameMessage');
            message.textContent = '‚ùå –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±—É–∫–≤–∞ –∏–ª–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ.';
            message.className = 'message error';
            
            setTimeout(() => {
                initSnakeGame(currentWord);
                message.textContent = '';
                message.className = 'message';
            }, 2000);
        }

        function processWordComplete() {
            clearSnakeInterval();
            score += 10;
            wordsCompleted++;
            
            const message = document.getElementById('gameMessage');
            message.textContent = `üéâ –û—Ç–ª–∏—á–Ω–æ! –°–ª–æ–≤–æ "${currentWord}" —Å–æ–±—Ä–∞–Ω–æ!`;
            message.className = 'message success';
            
            updateUI();
            
            setTimeout(() => {
                message.textContent = '';
                message.className = 'message';
                nextWord();
            }, 1500);
        }

        function updateUI() {
            document.getElementById('score').textContent = score;
            const progress = (currentWordIndex / LEVELS[currentLevel].words.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function endGame() {
            stopGame();
            document.getElementById('finalScore').textContent = `${wordsCompleted}/${LEVELS[currentLevel].words.length}`;
            
            let message = '';
            if (wordsCompleted === LEVELS[currentLevel].words.length) {
                message = "–ü–æ—Ç—Ä—è—Å–∞—é—â–µ! –í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —É—Ä–æ–≤–µ–Ω—å!";
            } else if (wordsCompleted >= LEVELS[currentLevel].words.length / 2) {
                message = "–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!";
            } else {
                message = "–ù–µ–ø–ª–æ—Ö–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞!";
            }
            
            document.getElementById('resultsMessage').textContent = message;
            showScreen('resultsScreen');
        }

        function stopGame() {
            clearSnakeInterval();
        }

        function restartGame() {
            startGame();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–º–µ–π–∫–æ–π —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', (e) => {
            if (!snakeInterval) return;
            
            switch(e.key) {
                case 'ArrowUp': 
                    e.preventDefault();
                    changeSnakeDirection('up'); 
                    break;
                case 'ArrowDown': 
                    e.preventDefault();
                    changeSnakeDirection('down'); 
                    break;
                case 'ArrowLeft': 
                    e.preventDefault();
                    changeSnakeDirection('left'); 
                    break;
                case 'ArrowRight': 
                    e.preventDefault();
                    changeSnakeDirection('right'); 
                    break;
            }
        });
    </script>
</body>
</html>
