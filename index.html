<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EnglishBoost - –ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</title>
    <meta name="theme-color" content="#58cc02">
    <style>
        /* ... (–ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */

        /* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∑–º–µ–π–∫–∏ */
        .snake-container {
            display: none;
            margin-bottom: 30px;
        }

        .question-container.snake-mode .snake-container {
            display: block;
        }

        .question-container.snake-mode .options-grid,
        .question-container.snake-mode .game-area,
        .question-container.snake-mode .input-container,
        .question-container.snake-mode .voice-container,
        .question-container.snake-mode .puzzle-container {
            display: none;
        }

        .snake-game-area {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 400px;
            margin: 0 auto;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
            border-radius: 15px;
            border: 3px solid #dfe4ea;
            overflow: hidden;
        }

        .snake-segment {
            position: absolute;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            border-radius: 4px;
            transition: all 0.1s linear;
            z-index: 2;
        }

        .snake-head {
            background: linear-gradient(135deg, #0984e3 0%, #6c5ce7 100%);
            box-shadow: 0 2px 8px rgba(9, 132, 227, 0.6);
            z-index: 3;
        }

        .letter-food {
            position: absolute;
            width: 25px;
            height: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1em;
            box-shadow: 0 3px 8px rgba(102, 126, 234, 0.4);
            z-index: 1;
            transition: all 0.3s ease;
        }

        .letter-food.target {
            background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
            animation: pulse 1s infinite;
            transform: scale(1.2);
            z-index: 4;
        }

        .snake-word-display {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e8e8e8;
        }

        .snake-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 20px auto;
            width: 180px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .snake-btn {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            box-shadow: 0 3px 6px rgba(102, 126, 234, 0.3);
            user-select: none;
        }

        .snake-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.5);
        }

        .snake-btn:active {
            transform: scale(0.95);
        }

        .snake-btn.up { grid-column: 2; grid-row: 1; }
        .snake-btn.left { grid-column: 1; grid-row: 2; }
        .snake-btn.right { grid-column: 3; grid-row: 2; }
        .snake-btn.down { grid-column: 2; grid-row: 3; }

        .snake-hint {
            text-align: center;
            color: #636e72;
            font-size: 0.9em;
            margin-top: 10px;
            padding: 0 20px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1.2); }
            50% { transform: scale(1.4); }
        }

        /* ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */
    </style>
</head>
<body>
    <div class="quiz-container">
        <!-- ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->

        <div class="main-content">
            <!-- ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->

            <div class="question-container" id="questionScreen">
                <!-- ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->

                <div class="snake-container">
                    <div class="snake-word-display" id="snakeWordDisplay">Collected: </div>
                    <div class="snake-game-area" id="snakeGameArea"></div>
                    <div class="snake-controls">
                        <button class="snake-btn up" onclick="changeSnakeDirection('up')">‚Üë</button>
                        <button class="snake-btn left" onclick="changeSnakeDirection('left')">‚Üê</button>
                        <button class="snake-btn right" onclick="changeSnakeDirection('right')">‚Üí</button>
                        <button class="snake-btn down" onclick="changeSnakeDirection('down')">‚Üì</button>
                    </div>
                    <div class="snake-hint">–°–æ–±–µ—Ä–∏—Ç–µ –±—É–∫–≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–º–µ–π–∫–æ–π</div>
                </div>
                
                <div class="feedback" id="feedback"></div>
            </div>

            <!-- ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->
        </div>
    </div>

    <script>
        // ... (–ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–º–µ–π–∫–∏
        function initSnakeGame(word) {
            console.log("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–º–µ–π–∫–∏ –¥–ª—è —Å–ª–æ–≤–∞:", word);
            snakeTargetWord = word.toUpperCase();
            collectedLetters = '';
            snakeDirection = 'right';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–º–µ–π–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
            const centerX = 200;
            const centerY = 200;
            snake = [
                { x: centerX, y: centerY },
                { x: centerX - 20, y: centerY },
                { x: centerX - 40, y: centerY }
            ];

            // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –±—É–∫–≤ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –æ—Ç –∑–º–µ–π–∫–∏
            letterPositions = [];
            const letters = snakeTargetWord.split('');
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –±—É–∫–≤—ã —Ü–µ–ª–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
            letters.forEach((letter, index) => {
                let pos = getRandomSafePosition();
                letterPositions.push({ letter, x: pos.x, y: pos.y, isTarget: true, index });
            });

            // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–π–Ω—ã—Ö –±—É–∫–≤ –≤ 2 —Ä–∞–∑–∞ (–±—ã–ª–æ 10, —Å—Ç–∞–ª–æ 5)
            for (let i = 0; i < 5; i++) {
                const randomLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                let pos = getRandomSafePosition();
                letterPositions.push({ letter: randomLetter, x: pos.x, y: pos.y, isTarget: false });
            }

            updateSnakeDisplay();
            renderSnakeGame();
            
            clearSnakeInterval();
            snakeInterval = setInterval(moveSnake, snakeSpeed);
        }

        function getRandomSafePosition() {
            const safeDistance = 80; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
            let attempts = 0;
            let pos;
            
            do {
                pos = {
                    x: Math.floor(Math.random() * 18) * 20 + 10,
                    y: Math.floor(Math.random() * 18) * 20 + 10
                };
                attempts++;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ (200,200)
                const distanceFromCenter = Math.sqrt(
                    Math.pow(pos.x - 200, 2) + Math.pow(pos.y - 200, 2)
                );
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –∑–º–µ–π–∫–∏
                let tooCloseToSnake = snake.some(segment => 
                    Math.abs(segment.x - pos.x) < 40 && Math.abs(segment.y - pos.y) < 40
                );
                
                if (distanceFromCenter >= safeDistance && !tooCloseToSnake) {
                    return pos;
                }
                
            } while (attempts < 50); // –ú–∞–∫—Å–∏–º—É–º 50 –ø–æ–ø—ã—Ç–æ–∫
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ª—é–±—É—é
            return {
                x: Math.floor(Math.random() * 18) * 20 + 10,
                y: Math.floor(Math.random() * 18) * 20 + 10
            };
        }

        function renderSnakeGame() {
            const gameArea = document.getElementById('snakeGameArea');
            if (!gameArea) {
                console.error("Snake game area not found!");
                return;
            }
            gameArea.innerHTML = '';

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–º–µ–π–∫–∏
            snake.forEach((segment, index) => {
                const segmentEl = document.createElement('div');
                segmentEl.className = 'snake-segment' + (index === 0 ? ' snake-head' : '');
                segmentEl.style.left = segment.x + 'px';
                segmentEl.style.top = segment.y + 'px';
                gameArea.appendChild(segmentEl);
            });

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –±—É–∫–≤
            letterPositions.forEach((letterPos, index) => {
                const letterEl = document.createElement('div');
                letterEl.className = 'letter-food';
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Ü–µ–ª–µ–≤—É—é –±—É–∫–≤—É
                if (letterPos.isTarget && letterPos.index === collectedLetters.length) {
                    letterEl.classList.add('target');
                }
                
                letterEl.textContent = letterPos.letter;
                letterEl.style.left = (letterPos.x - 12.5) + 'px';
                letterEl.style.top = (letterPos.y - 12.5) + 'px';
                gameArea.appendChild(letterEl);
            });
        }

        function moveSnake() {
            if (answered) return;

            const head = { ...snake[0] };

            switch (snakeDirection) {
                case 'up': head.y -= 20; break;
                case 'down': head.y += 20; break;
                case 'left': head.x -= 20; break;
                case 'right': head.x += 20; break;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏
            if (head.x < 0 || head.x >= 400 || head.y < 0 || head.y >= 400) {
                gameOver();
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Å–æ–±–æ–π
            if (snake.some((segment, index) => index > 0 && segment.x === head.x && segment.y === head.y)) {
                gameOver();
                return;
            }

            snake.unshift(head);

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –±—É–∫–≤–æ–π
            const collisionIndex = letterPositions.findIndex(letter => 
                Math.abs(letter.x - head.x) < 20 && Math.abs(letter.y - head.y) < 20
            );

            if (collisionIndex !== -1) {
                const collectedLetter = letterPositions[collisionIndex];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–∏ —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∞—è –±—É–∫–≤–∞
                if (collectedLetter.isTarget && collectedLetter.index === collectedLetters.length) {
                    collectedLetters += collectedLetter.letter;
                    letterPositions.splice(collisionIndex, 1);
                    updateSnakeDisplay();

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–±—Ä–∞–Ω–æ –ª–∏ –≤—Å–µ —Å–ª–æ–≤–æ
                    if (collectedLetters === snakeTargetWord) {
                        processSnakeWin();
                        return;
                    }
                } else {
                    // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±—É–∫–≤–∞ - –∫–æ–Ω–µ—Ü –∏–≥—Ä—ã
                    gameOver();
                    return;
                }
            } else {
                snake.pop();
            }

            renderSnakeGame();
        }

        function changeSnakeDirection(newDirection) {
            const opposites = { up: 'down', down: 'up', left: 'right', right: 'left' };
            if (snakeDirection !== opposites[newDirection] && snake.length > 1) {
                snakeDirection = newDirection;
            } else if (snake.length === 1) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º —Ä–∞–∑–≤–æ—Ä–æ—Ç –µ—Å–ª–∏ –∑–º–µ–π–∫–∞ —Å–æ—Å—Ç–æ–∏—Ç —Ç–æ–ª—å–∫–æ –∏–∑ –≥–æ–ª–æ–≤—ã
                snakeDirection = newDirection;
            }
        }

        function updateSnakeDisplay() {
            const display = document.getElementById('snakeWordDisplay');
            if (display) {
                display.textContent = `Collected: ${collectedLetters} / ${snakeTargetWord}`;
            }
        }

        function clearSnakeInterval() {
            if (snakeInterval) {
                clearInterval(snakeInterval);
                snakeInterval = null;
            }
        }

        function gameOver() {
            clearSnakeInterval();
            const feedback = document.getElementById('feedback');
            if (feedback) {
                feedback.textContent = '‚ùå –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±—É–∫–≤–∞ –∏–ª–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ.';
                feedback.classList.add('incorrect', 'show');
            }
            
            setTimeout(() => {
                initSnakeGame(snakeTargetWord);
                if (feedback) feedback.classList.remove('show');
            }, 2000);
        }

        function processSnakeWin() {
            clearSnakeInterval();
            answered = true;
            
            const question = shuffledQuestions[currentQuestion];
            score += 10;
            wordProgress[question.question]++;
            
            const feedback = document.getElementById('feedback');
            if (feedback) {
                feedback.textContent = `üéâ –û—Ç–ª–∏—á–Ω–æ! –°–ª–æ–≤–æ "${snakeTargetWord}" —Å–æ–±—Ä–∞–Ω–æ!`;
                feedback.classList.add('correct', 'show');
            }
            
            updateUI();
            saveProgress();
            
            setTimeout(() => {
                currentQuestion++;
                displayQuestion();
            }, 2500);
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–º–µ–π–∫–æ–π —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', (e) => {
            if (!snakeInterval) return;
            
            switch(e.key) {
                case 'ArrowUp': 
                    e.preventDefault();
                    changeSnakeDirection('up'); 
                    break;
                case 'ArrowDown': 
                    e.preventDefault();
                    changeSnakeDirection('down'); 
                    break;
                case 'ArrowLeft': 
                    e.preventDefault();
                    changeSnakeDirection('left'); 
                    break;
                case 'ArrowRight': 
                    e.preventDefault();
                    changeSnakeDirection('right'); 
                    break;
            }
        });

        // ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...
    </script>
</body>
</html>
